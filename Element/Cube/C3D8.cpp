////////////////////////////////////////////////////////////////////////////////
// Copyright (C) 2017 Theodore Chang
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
////////////////////////////////////////////////////////////////////////////////

#include "C3D8.h"
#include <Domain/DomainBase.h>
#include <Domain/Node.h>
#include <Material/Material3D/Material3D.h>
#include <Toolbox/IntegrationPlan.h>
#include <Toolbox/shapeFunction.hpp>

const unsigned C3D8::c_node = 8;
const unsigned C3D8::c_dof = 3;

C3D8::IntegrationPoint::IntegrationPoint(const vec& C, const double W, const double J, unique_ptr<Material>&& M, const mat& PNPXY)
    : coor(C)
    , weight(W)
    , jacob_det(J)
    , c_material(move(M))
    , pn_pxy(PNPXY) {}

C3D8::C3D8(const unsigned& T, const uvec& N, const unsigned& M, const bool& R, const bool& F)
    : MaterialElement(T, ET_C3D8, c_node, c_dof, N, uvec{ M }, F)
    , reduced_scheme(R) {}

void C3D8::initialize(const shared_ptr<DomainBase>& D) {
    mat ele_coor(c_node, c_dof);
    for(unsigned I = 0; I < c_node; ++I) {
        auto& tmp_coor = node_ptr[I].lock()->get_coordinate();
        for(unsigned J = 0; J < c_dof; ++J) ele_coor(I, J) = tmp_coor(J);
    }

    const auto& material_proto = D->get_material(static_cast<unsigned>(material_tag(0)));

    const IntegrationPlan plan(3, reduced_scheme ? 1 : 2, IntegrationType::GAUSS);

    int_pt.clear();
    int_pt.reserve(plan.n_rows);
    for(unsigned I = 0; I < plan.n_rows; ++I) {
        const vec t_vec{ plan(I, 0), plan(I, 1), plan(I, 2) };
        const auto pn = shape::cube(t_vec, 1);
        const mat jacob = pn * ele_coor;
        int_pt.emplace_back(t_vec, plan(I, c_dof), det(jacob), material_proto->get_copy(), solve(jacob, pn));
    }

    mass.zeros();
    const auto tmp_density = material_proto->get_parameter();
    if(tmp_density != 0.) {
        for(const auto& I : int_pt) {
            const auto n_int = shape::cube(I.coor, 0);
            const auto tmp_a = tmp_density * I.jacob_det * I.weight;
            for(auto J = 0; J < c_node; ++J)
                for(auto K = J; K < c_node; ++K) mass(c_dof * J, c_dof * K) += tmp_a * n_int(J) * n_int(K);
        }
        for(auto I = 0; I < c_node * c_dof; I += c_dof) {
            mass(I + 1, I + 1) = mass(I + 2, I + 2) = mass(I, I);
            for(auto J = I + c_dof; J < c_node * c_dof; J += c_dof) mass(J, I) = mass(I + 1, J + 1) = mass(I + 2, J + 2) = mass(J + 1, I + 1) = mass(J + 2, I + 2) = mass(I, J);
        }
    }
}

int C3D8::update_status() {
    auto code = 0;

    vec t_strain(6);

    stiffness.zeros();
    resistance.zeros();
    for(const auto& I : int_pt) {
        t_strain.zeros();
        for(auto J = 0; J < c_node; ++J) {
            const auto& t_disp = node_ptr[J].lock()->get_trial_displacement();
            t_strain(0) += t_disp(0) * I.pn_pxy(0, J);
            t_strain(1) += t_disp(1) * I.pn_pxy(1, J);
            t_strain(2) += t_disp(2) * I.pn_pxy(2, J);
            t_strain(3) += t_disp(0) * I.pn_pxy(1, J) + t_disp(1) * I.pn_pxy(0, J);
            t_strain(4) += t_disp(1) * I.pn_pxy(2, J) + t_disp(2) * I.pn_pxy(1, J);
            t_strain(5) += t_disp(0) * I.pn_pxy(2, J) + t_disp(2) * I.pn_pxy(0, J);
        }
        code += I.c_material->update_trial_status(t_strain);

        const auto t_factor = I.jacob_det * I.weight;

        auto& t_stiff = I.c_material->get_stiffness();
        auto& t_stress = I.c_material->get_stress();

        const auto& NX1 = I.pn_pxy(0, 0);
        const auto& NY1 = I.pn_pxy(1, 0);
        const auto& NZ1 = I.pn_pxy(2, 0);
        const auto& NX2 = I.pn_pxy(0, 1);
        const auto& NY2 = I.pn_pxy(1, 1);
        const auto& NZ2 = I.pn_pxy(2, 1);
        const auto& NX3 = I.pn_pxy(0, 2);
        const auto& NY3 = I.pn_pxy(1, 2);
        const auto& NZ3 = I.pn_pxy(2, 2);
        const auto& NX4 = I.pn_pxy(0, 3);
        const auto& NY4 = I.pn_pxy(1, 3);
        const auto& NZ4 = I.pn_pxy(2, 3);
        const auto& NX5 = I.pn_pxy(0, 4);
        const auto& NY5 = I.pn_pxy(1, 4);
        const auto& NZ5 = I.pn_pxy(2, 4);
        const auto& NX6 = I.pn_pxy(0, 5);
        const auto& NY6 = I.pn_pxy(1, 5);
        const auto& NZ6 = I.pn_pxy(2, 5);
        const auto& NX7 = I.pn_pxy(0, 6);
        const auto& NY7 = I.pn_pxy(1, 6);
        const auto& NZ7 = I.pn_pxy(2, 6);
        const auto& NX8 = I.pn_pxy(0, 7);
        const auto& NY8 = I.pn_pxy(1, 7);
        const auto& NZ8 = I.pn_pxy(2, 7);

        const auto D11 = t_factor * t_stiff(0, 0);
        const auto D12 = t_factor * t_stiff(0, 1);
        const auto D13 = t_factor * t_stiff(0, 2);
        const auto D14 = t_factor * t_stiff(0, 3);
        const auto D15 = t_factor * t_stiff(0, 4);
        const auto D16 = t_factor * t_stiff(0, 5);
        const auto D22 = t_factor * t_stiff(1, 1);
        const auto D23 = t_factor * t_stiff(1, 2);
        const auto D24 = t_factor * t_stiff(1, 3);
        const auto D25 = t_factor * t_stiff(1, 4);
        const auto D26 = t_factor * t_stiff(1, 5);
        const auto D33 = t_factor * t_stiff(2, 2);
        const auto D34 = t_factor * t_stiff(2, 3);
        const auto D35 = t_factor * t_stiff(2, 4);
        const auto D36 = t_factor * t_stiff(2, 5);
        const auto D44 = t_factor * t_stiff(3, 3);
        const auto D45 = t_factor * t_stiff(3, 4);
        const auto D46 = t_factor * t_stiff(3, 5);
        const auto D55 = t_factor * t_stiff(4, 4);
        const auto D56 = t_factor * t_stiff(4, 5);
        const auto D66 = t_factor * t_stiff(5, 5);

        const auto S1 = t_factor * t_stress(0);
        const auto S2 = t_factor * t_stress(1);
        const auto S3 = t_factor * t_stress(2);
        const auto S4 = t_factor * t_stress(3);
        const auto S5 = t_factor * t_stress(4);
        const auto S6 = t_factor * t_stress(5);

        // 1253+880 (4320+3600)
        const auto D11NX1 = D11 * NX1;
        const auto D11NX2 = D11 * NX2;
        const auto D11NX3 = D11 * NX3;
        const auto D11NX4 = D11 * NX4;
        const auto D11NX5 = D11 * NX5;
        const auto D11NX6 = D11 * NX6;
        const auto D11NX7 = D11 * NX7;
        const auto D11NX8 = D11 * NX8;
        const auto D12NX1 = D12 * NX1;
        const auto D12NX2 = D12 * NX2;
        const auto D12NX3 = D12 * NX3;
        const auto D12NX4 = D12 * NX4;
        const auto D12NX5 = D12 * NX5;
        const auto D12NX6 = D12 * NX6;
        const auto D12NX7 = D12 * NX7;
        const auto D12NX8 = D12 * NX8;
        const auto D12NY1 = D12 * NY1;
        const auto D12NY2 = D12 * NY2;
        const auto D12NY3 = D12 * NY3;
        const auto D12NY4 = D12 * NY4;
        const auto D12NY5 = D12 * NY5;
        const auto D12NY6 = D12 * NY6;
        const auto D12NY7 = D12 * NY7;
        const auto D13NX1 = D13 * NX1;
        const auto D13NX2 = D13 * NX2;
        const auto D13NX3 = D13 * NX3;
        const auto D13NX4 = D13 * NX4;
        const auto D13NX5 = D13 * NX5;
        const auto D13NX6 = D13 * NX6;
        const auto D13NX7 = D13 * NX7;
        const auto D13NX8 = D13 * NX8;
        const auto D13NZ1 = D13 * NZ1;
        const auto D13NZ2 = D13 * NZ2;
        const auto D13NZ3 = D13 * NZ3;
        const auto D13NZ4 = D13 * NZ4;
        const auto D13NZ5 = D13 * NZ5;
        const auto D13NZ6 = D13 * NZ6;
        const auto D13NZ7 = D13 * NZ7;
        const auto D14NX1 = D14 * NX1;
        const auto D14NX2 = D14 * NX2;
        const auto D14NX3 = D14 * NX3;
        const auto D14NX4 = D14 * NX4;
        const auto D14NX5 = D14 * NX5;
        const auto D14NX6 = D14 * NX6;
        const auto D14NX7 = D14 * NX7;
        const auto D14NX8 = D14 * NX8;
        const auto D14NY1 = D14 * NY1;
        const auto D14NY2 = D14 * NY2;
        const auto D14NY3 = D14 * NY3;
        const auto D14NY4 = D14 * NY4;
        const auto D14NY5 = D14 * NY5;
        const auto D14NY6 = D14 * NY6;
        const auto D14NY7 = D14 * NY7;
        const auto D14NY8 = D14 * NY8;
        const auto D15NX1 = D15 * NX1;
        const auto D15NX2 = D15 * NX2;
        const auto D15NX3 = D15 * NX3;
        const auto D15NX4 = D15 * NX4;
        const auto D15NX5 = D15 * NX5;
        const auto D15NX6 = D15 * NX6;
        const auto D15NX7 = D15 * NX7;
        const auto D15NX8 = D15 * NX8;
        const auto D15NY1 = D15 * NY1;
        const auto D15NY2 = D15 * NY2;
        const auto D15NY3 = D15 * NY3;
        const auto D15NY4 = D15 * NY4;
        const auto D15NY5 = D15 * NY5;
        const auto D15NY6 = D15 * NY6;
        const auto D15NY7 = D15 * NY7;
        const auto D15NZ1 = D15 * NZ1;
        const auto D15NZ2 = D15 * NZ2;
        const auto D15NZ3 = D15 * NZ3;
        const auto D15NZ4 = D15 * NZ4;
        const auto D15NZ5 = D15 * NZ5;
        const auto D15NZ6 = D15 * NZ6;
        const auto D15NZ7 = D15 * NZ7;
        const auto D16NX1 = D16 * NX1;
        const auto D16NX2 = D16 * NX2;
        const auto D16NX3 = D16 * NX3;
        const auto D16NX4 = D16 * NX4;
        const auto D16NX5 = D16 * NX5;
        const auto D16NX6 = D16 * NX6;
        const auto D16NX7 = D16 * NX7;
        const auto D16NX8 = D16 * NX8;
        const auto D16NZ1 = D16 * NZ1;
        const auto D16NZ2 = D16 * NZ2;
        const auto D16NZ3 = D16 * NZ3;
        const auto D16NZ4 = D16 * NZ4;
        const auto D16NZ5 = D16 * NZ5;
        const auto D16NZ6 = D16 * NZ6;
        const auto D16NZ7 = D16 * NZ7;
        const auto D16NZ8 = D16 * NZ8;
        const auto D22NY1 = D22 * NY1;
        const auto D22NY2 = D22 * NY2;
        const auto D22NY3 = D22 * NY3;
        const auto D22NY4 = D22 * NY4;
        const auto D22NY5 = D22 * NY5;
        const auto D22NY6 = D22 * NY6;
        const auto D22NY7 = D22 * NY7;
        const auto D22NY8 = D22 * NY8;
        const auto D23NY1 = D23 * NY1;
        const auto D23NY2 = D23 * NY2;
        const auto D23NY3 = D23 * NY3;
        const auto D23NY4 = D23 * NY4;
        const auto D23NY5 = D23 * NY5;
        const auto D23NY6 = D23 * NY6;
        const auto D23NY7 = D23 * NY7;
        const auto D23NY8 = D23 * NY8;
        const auto D23NZ1 = D23 * NZ1;
        const auto D23NZ2 = D23 * NZ2;
        const auto D23NZ3 = D23 * NZ3;
        const auto D23NZ4 = D23 * NZ4;
        const auto D23NZ5 = D23 * NZ5;
        const auto D23NZ6 = D23 * NZ6;
        const auto D23NZ7 = D23 * NZ7;
        const auto D24NX1 = D24 * NX1;
        const auto D24NX2 = D24 * NX2;
        const auto D24NX3 = D24 * NX3;
        const auto D24NX4 = D24 * NX4;
        const auto D24NX5 = D24 * NX5;
        const auto D24NX6 = D24 * NX6;
        const auto D24NX7 = D24 * NX7;
        const auto D24NX8 = D24 * NX8;
        const auto D24NY1 = D24 * NY1;
        const auto D24NY2 = D24 * NY2;
        const auto D24NY3 = D24 * NY3;
        const auto D24NY4 = D24 * NY4;
        const auto D24NY5 = D24 * NY5;
        const auto D24NY6 = D24 * NY6;
        const auto D24NY7 = D24 * NY7;
        const auto D24NY8 = D24 * NY8;
        const auto D25NY1 = D25 * NY1;
        const auto D25NY2 = D25 * NY2;
        const auto D25NY3 = D25 * NY3;
        const auto D25NY4 = D25 * NY4;
        const auto D25NY5 = D25 * NY5;
        const auto D25NY6 = D25 * NY6;
        const auto D25NY7 = D25 * NY7;
        const auto D25NY8 = D25 * NY8;
        const auto D25NZ1 = D25 * NZ1;
        const auto D25NZ2 = D25 * NZ2;
        const auto D25NZ3 = D25 * NZ3;
        const auto D25NZ4 = D25 * NZ4;
        const auto D25NZ5 = D25 * NZ5;
        const auto D25NZ6 = D25 * NZ6;
        const auto D25NZ7 = D25 * NZ7;
        const auto D25NZ8 = D25 * NZ8;
        const auto D26NX1 = D26 * NX1;
        const auto D26NX2 = D26 * NX2;
        const auto D26NX3 = D26 * NX3;
        const auto D26NX4 = D26 * NX4;
        const auto D26NX5 = D26 * NX5;
        const auto D26NX6 = D26 * NX6;
        const auto D26NX7 = D26 * NX7;
        const auto D26NY1 = D26 * NY1;
        const auto D26NY2 = D26 * NY2;
        const auto D26NY3 = D26 * NY3;
        const auto D26NY4 = D26 * NY4;
        const auto D26NY5 = D26 * NY5;
        const auto D26NY6 = D26 * NY6;
        const auto D26NY7 = D26 * NY7;
        const auto D26NY8 = D26 * NY8;
        const auto D26NZ1 = D26 * NZ1;
        const auto D26NZ2 = D26 * NZ2;
        const auto D26NZ3 = D26 * NZ3;
        const auto D26NZ4 = D26 * NZ4;
        const auto D26NZ5 = D26 * NZ5;
        const auto D26NZ6 = D26 * NZ6;
        const auto D26NZ7 = D26 * NZ7;
        const auto D26NZ8 = D26 * NZ8;
        const auto D33NZ1 = D33 * NZ1;
        const auto D33NZ2 = D33 * NZ2;
        const auto D33NZ3 = D33 * NZ3;
        const auto D33NZ4 = D33 * NZ4;
        const auto D33NZ5 = D33 * NZ5;
        const auto D33NZ6 = D33 * NZ6;
        const auto D33NZ7 = D33 * NZ7;
        const auto D33NZ8 = D33 * NZ8;
        const auto D34NX1 = D34 * NX1;
        const auto D34NX2 = D34 * NX2;
        const auto D34NX3 = D34 * NX3;
        const auto D34NX4 = D34 * NX4;
        const auto D34NX5 = D34 * NX5;
        const auto D34NX6 = D34 * NX6;
        const auto D34NX7 = D34 * NX7;
        const auto D34NX8 = D34 * NX8;
        const auto D34NY1 = D34 * NY1;
        const auto D34NY2 = D34 * NY2;
        const auto D34NY3 = D34 * NY3;
        const auto D34NY4 = D34 * NY4;
        const auto D34NY5 = D34 * NY5;
        const auto D34NY6 = D34 * NY6;
        const auto D34NY7 = D34 * NY7;
        const auto D34NY8 = D34 * NY8;
        const auto D34NZ1 = D34 * NZ1;
        const auto D34NZ2 = D34 * NZ2;
        const auto D34NZ3 = D34 * NZ3;
        const auto D34NZ4 = D34 * NZ4;
        const auto D34NZ5 = D34 * NZ5;
        const auto D34NZ6 = D34 * NZ6;
        const auto D34NZ7 = D34 * NZ7;
        const auto D35NY1 = D35 * NY1;
        const auto D35NY2 = D35 * NY2;
        const auto D35NY3 = D35 * NY3;
        const auto D35NY4 = D35 * NY4;
        const auto D35NY5 = D35 * NY5;
        const auto D35NY6 = D35 * NY6;
        const auto D35NY7 = D35 * NY7;
        const auto D35NY8 = D35 * NY8;
        const auto D35NZ1 = D35 * NZ1;
        const auto D35NZ2 = D35 * NZ2;
        const auto D35NZ3 = D35 * NZ3;
        const auto D35NZ4 = D35 * NZ4;
        const auto D35NZ5 = D35 * NZ5;
        const auto D35NZ6 = D35 * NZ6;
        const auto D35NZ7 = D35 * NZ7;
        const auto D35NZ8 = D35 * NZ8;
        const auto D36NX1 = D36 * NX1;
        const auto D36NX2 = D36 * NX2;
        const auto D36NX3 = D36 * NX3;
        const auto D36NX4 = D36 * NX4;
        const auto D36NX5 = D36 * NX5;
        const auto D36NX6 = D36 * NX6;
        const auto D36NX7 = D36 * NX7;
        const auto D36NX8 = D36 * NX8;
        const auto D36NZ1 = D36 * NZ1;
        const auto D36NZ2 = D36 * NZ2;
        const auto D36NZ3 = D36 * NZ3;
        const auto D36NZ4 = D36 * NZ4;
        const auto D36NZ5 = D36 * NZ5;
        const auto D36NZ6 = D36 * NZ6;
        const auto D36NZ7 = D36 * NZ7;
        const auto D36NZ8 = D36 * NZ8;
        const auto D44NX1 = D44 * NX1;
        const auto D44NX2 = D44 * NX2;
        const auto D44NX3 = D44 * NX3;
        const auto D44NX4 = D44 * NX4;
        const auto D44NX5 = D44 * NX5;
        const auto D44NX6 = D44 * NX6;
        const auto D44NX7 = D44 * NX7;
        const auto D44NX8 = D44 * NX8;
        const auto D44NY1 = D44 * NY1;
        const auto D44NY2 = D44 * NY2;
        const auto D44NY3 = D44 * NY3;
        const auto D44NY4 = D44 * NY4;
        const auto D44NY5 = D44 * NY5;
        const auto D44NY6 = D44 * NY6;
        const auto D44NY7 = D44 * NY7;
        const auto D44NY8 = D44 * NY8;
        const auto D45NX1 = D45 * NX1;
        const auto D45NX2 = D45 * NX2;
        const auto D45NX3 = D45 * NX3;
        const auto D45NX4 = D45 * NX4;
        const auto D45NX5 = D45 * NX5;
        const auto D45NX6 = D45 * NX6;
        const auto D45NX7 = D45 * NX7;
        const auto D45NX8 = D45 * NX8;
        const auto D45NY1 = D45 * NY1;
        const auto D45NY2 = D45 * NY2;
        const auto D45NY3 = D45 * NY3;
        const auto D45NY4 = D45 * NY4;
        const auto D45NY5 = D45 * NY5;
        const auto D45NY6 = D45 * NY6;
        const auto D45NY7 = D45 * NY7;
        const auto D45NY8 = D45 * NY8;
        const auto D45NZ1 = D45 * NZ1;
        const auto D45NZ2 = D45 * NZ2;
        const auto D45NZ3 = D45 * NZ3;
        const auto D45NZ4 = D45 * NZ4;
        const auto D45NZ5 = D45 * NZ5;
        const auto D45NZ6 = D45 * NZ6;
        const auto D45NZ7 = D45 * NZ7;
        const auto D45NZ8 = D45 * NZ8;
        const auto D46NX1 = D46 * NX1;
        const auto D46NX2 = D46 * NX2;
        const auto D46NX3 = D46 * NX3;
        const auto D46NX4 = D46 * NX4;
        const auto D46NX5 = D46 * NX5;
        const auto D46NX6 = D46 * NX6;
        const auto D46NX7 = D46 * NX7;
        const auto D46NX8 = D46 * NX8;
        const auto D46NY1 = D46 * NY1;
        const auto D46NY2 = D46 * NY2;
        const auto D46NY3 = D46 * NY3;
        const auto D46NY4 = D46 * NY4;
        const auto D46NY5 = D46 * NY5;
        const auto D46NY6 = D46 * NY6;
        const auto D46NY7 = D46 * NY7;
        const auto D46NY8 = D46 * NY8;
        const auto D46NZ1 = D46 * NZ1;
        const auto D46NZ2 = D46 * NZ2;
        const auto D46NZ3 = D46 * NZ3;
        const auto D46NZ4 = D46 * NZ4;
        const auto D46NZ5 = D46 * NZ5;
        const auto D46NZ6 = D46 * NZ6;
        const auto D46NZ7 = D46 * NZ7;
        const auto D46NZ8 = D46 * NZ8;
        const auto D55NY1 = D55 * NY1;
        const auto D55NY2 = D55 * NY2;
        const auto D55NY3 = D55 * NY3;
        const auto D55NY4 = D55 * NY4;
        const auto D55NY5 = D55 * NY5;
        const auto D55NY6 = D55 * NY6;
        const auto D55NY7 = D55 * NY7;
        const auto D55NY8 = D55 * NY8;
        const auto D55NZ1 = D55 * NZ1;
        const auto D55NZ2 = D55 * NZ2;
        const auto D55NZ3 = D55 * NZ3;
        const auto D55NZ4 = D55 * NZ4;
        const auto D55NZ5 = D55 * NZ5;
        const auto D55NZ6 = D55 * NZ6;
        const auto D55NZ7 = D55 * NZ7;
        const auto D55NZ8 = D55 * NZ8;
        const auto D56NX1 = D56 * NX1;
        const auto D56NX2 = D56 * NX2;
        const auto D56NX3 = D56 * NX3;
        const auto D56NX4 = D56 * NX4;
        const auto D56NX5 = D56 * NX5;
        const auto D56NX6 = D56 * NX6;
        const auto D56NX7 = D56 * NX7;
        const auto D56NX8 = D56 * NX8;
        const auto D56NY1 = D56 * NY1;
        const auto D56NY2 = D56 * NY2;
        const auto D56NY3 = D56 * NY3;
        const auto D56NY4 = D56 * NY4;
        const auto D56NY5 = D56 * NY5;
        const auto D56NY6 = D56 * NY6;
        const auto D56NY7 = D56 * NY7;
        const auto D56NY8 = D56 * NY8;
        const auto D56NZ1 = D56 * NZ1;
        const auto D56NZ2 = D56 * NZ2;
        const auto D56NZ3 = D56 * NZ3;
        const auto D56NZ4 = D56 * NZ4;
        const auto D56NZ5 = D56 * NZ5;
        const auto D56NZ6 = D56 * NZ6;
        const auto D56NZ7 = D56 * NZ7;
        const auto D56NZ8 = D56 * NZ8;
        const auto D66NX1 = D66 * NX1;
        const auto D66NX2 = D66 * NX2;
        const auto D66NX3 = D66 * NX3;
        const auto D66NX4 = D66 * NX4;
        const auto D66NX5 = D66 * NX5;
        const auto D66NX6 = D66 * NX6;
        const auto D66NX7 = D66 * NX7;
        const auto D66NX8 = D66 * NX8;
        const auto D66NZ1 = D66 * NZ1;
        const auto D66NZ2 = D66 * NZ2;
        const auto D66NZ3 = D66 * NZ3;
        const auto D66NZ4 = D66 * NZ4;
        const auto D66NZ5 = D66 * NZ5;
        const auto D66NZ6 = D66 * NZ6;
        const auto D66NZ7 = D66 * NZ7;
        const auto D66NZ8 = D66 * NZ8;

        const auto D11NX1D14NY1D16NZ1 = D11NX1 + D14NY1 + D16NZ1;
        const auto D11NX2D14NY2D16NZ2 = D11NX2 + D14NY2 + D16NZ2;
        const auto D11NX3D14NY3D16NZ3 = D11NX3 + D14NY3 + D16NZ3;
        const auto D11NX4D14NY4D16NZ4 = D11NX4 + D14NY4 + D16NZ4;
        const auto D11NX5D14NY5D16NZ5 = D11NX5 + D14NY5 + D16NZ5;
        const auto D11NX6D14NY6D16NZ6 = D11NX6 + D14NY6 + D16NZ6;
        const auto D11NX7D14NY7D16NZ7 = D11NX7 + D14NY7 + D16NZ7;
        const auto D11NX8D14NY8D16NZ8 = D11NX8 + D14NY8 + D16NZ8;
        const auto D12NX1D24NY1D26NZ1 = D12NX1 + D24NY1 + D26NZ1;
        const auto D12NX2D24NY2D26NZ2 = D12NX2 + D24NY2 + D26NZ2;
        const auto D12NX3D24NY3D26NZ3 = D12NX3 + D24NY3 + D26NZ3;
        const auto D12NX4D24NY4D26NZ4 = D12NX4 + D24NY4 + D26NZ4;
        const auto D12NX5D24NY5D26NZ5 = D12NX5 + D24NY5 + D26NZ5;
        const auto D12NX6D24NY6D26NZ6 = D12NX6 + D24NY6 + D26NZ6;
        const auto D12NX7D24NY7D26NZ7 = D12NX7 + D24NY7 + D26NZ7;
        const auto D12NX8D24NY8D26NZ8 = D12NX8 + D24NY8 + D26NZ8;
        const auto D13NX1D34NY1D36NZ1 = D13NX1 + D34NY1 + D36NZ1;
        const auto D13NX2D34NY2D36NZ2 = D13NX2 + D34NY2 + D36NZ2;
        const auto D13NX3D34NY3D36NZ3 = D13NX3 + D34NY3 + D36NZ3;
        const auto D13NX4D34NY4D36NZ4 = D13NX4 + D34NY4 + D36NZ4;
        const auto D13NX5D34NY5D36NZ5 = D13NX5 + D34NY5 + D36NZ5;
        const auto D13NX6D34NY6D36NZ6 = D13NX6 + D34NY6 + D36NZ6;
        const auto D13NX7D34NY7D36NZ7 = D13NX7 + D34NY7 + D36NZ7;
        const auto D13NX8D34NY8D36NZ8 = D13NX8 + D34NY8 + D36NZ8;
        const auto D14NX1D12NY1D15NZ1 = D14NX1 + D12NY1 + D15NZ1;
        const auto D14NX1D44NY1D46NZ1 = D14NX1 + D44NY1 + D46NZ1;
        const auto D14NX2D12NY2D15NZ2 = D14NX2 + D12NY2 + D15NZ2;
        const auto D14NX2D44NY2D46NZ2 = D14NX2 + D44NY2 + D46NZ2;
        const auto D14NX3D12NY3D15NZ3 = D14NX3 + D12NY3 + D15NZ3;
        const auto D14NX3D44NY3D46NZ3 = D14NX3 + D44NY3 + D46NZ3;
        const auto D14NX4D12NY4D15NZ4 = D14NX4 + D12NY4 + D15NZ4;
        const auto D14NX4D44NY4D46NZ4 = D14NX4 + D44NY4 + D46NZ4;
        const auto D14NX5D12NY5D15NZ5 = D14NX5 + D12NY5 + D15NZ5;
        const auto D14NX5D44NY5D46NZ5 = D14NX5 + D44NY5 + D46NZ5;
        const auto D14NX6D12NY6D15NZ6 = D14NX6 + D12NY6 + D15NZ6;
        const auto D14NX6D44NY6D46NZ6 = D14NX6 + D44NY6 + D46NZ6;
        const auto D14NX7D12NY7D15NZ7 = D14NX7 + D12NY7 + D15NZ7;
        const auto D14NX7D44NY7D46NZ7 = D14NX7 + D44NY7 + D46NZ7;
        const auto D14NX8D44NY8D46NZ8 = D14NX8 + D44NY8 + D46NZ8;
        const auto D15NX1D45NY1D56NZ1 = D15NX1 + D45NY1 + D56NZ1;
        const auto D15NX2D45NY2D56NZ2 = D15NX2 + D45NY2 + D56NZ2;
        const auto D15NX3D45NY3D56NZ3 = D15NX3 + D45NY3 + D56NZ3;
        const auto D15NX4D45NY4D56NZ4 = D15NX4 + D45NY4 + D56NZ4;
        const auto D15NX5D45NY5D56NZ5 = D15NX5 + D45NY5 + D56NZ5;
        const auto D15NX6D45NY6D56NZ6 = D15NX6 + D45NY6 + D56NZ6;
        const auto D15NX7D45NY7D56NZ7 = D15NX7 + D45NY7 + D56NZ7;
        const auto D15NX8D45NY8D56NZ8 = D15NX8 + D45NY8 + D56NZ8;
        const auto D16NX1D15NY1D13NZ1 = D16NX1 + D15NY1 + D13NZ1;
        const auto D16NX1D46NY1D66NZ1 = D16NX1 + D46NY1 + D66NZ1;
        const auto D16NX2D15NY2D13NZ2 = D16NX2 + D15NY2 + D13NZ2;
        const auto D16NX2D46NY2D66NZ2 = D16NX2 + D46NY2 + D66NZ2;
        const auto D16NX3D15NY3D13NZ3 = D16NX3 + D15NY3 + D13NZ3;
        const auto D16NX3D46NY3D66NZ3 = D16NX3 + D46NY3 + D66NZ3;
        const auto D16NX4D15NY4D13NZ4 = D16NX4 + D15NY4 + D13NZ4;
        const auto D16NX4D46NY4D66NZ4 = D16NX4 + D46NY4 + D66NZ4;
        const auto D16NX5D15NY5D13NZ5 = D16NX5 + D15NY5 + D13NZ5;
        const auto D16NX5D46NY5D66NZ5 = D16NX5 + D46NY5 + D66NZ5;
        const auto D16NX6D15NY6D13NZ6 = D16NX6 + D15NY6 + D13NZ6;
        const auto D16NX6D46NY6D66NZ6 = D16NX6 + D46NY6 + D66NZ6;
        const auto D16NX7D15NY7D13NZ7 = D16NX7 + D15NY7 + D13NZ7;
        const auto D16NX7D46NY7D66NZ7 = D16NX7 + D46NY7 + D66NZ7;
        const auto D16NX8D46NY8D66NZ8 = D16NX8 + D46NY8 + D66NZ8;
        const auto D24NX1D22NY1D25NZ1 = D24NX1 + D22NY1 + D25NZ1;
        const auto D24NX2D22NY2D25NZ2 = D24NX2 + D22NY2 + D25NZ2;
        const auto D24NX3D22NY3D25NZ3 = D24NX3 + D22NY3 + D25NZ3;
        const auto D24NX4D22NY4D25NZ4 = D24NX4 + D22NY4 + D25NZ4;
        const auto D24NX5D22NY5D25NZ5 = D24NX5 + D22NY5 + D25NZ5;
        const auto D24NX6D22NY6D25NZ6 = D24NX6 + D22NY6 + D25NZ6;
        const auto D24NX7D22NY7D25NZ7 = D24NX7 + D22NY7 + D25NZ7;
        const auto D24NX8D22NY8D25NZ8 = D24NX8 + D22NY8 + D25NZ8;
        const auto D26NX1D25NY1D23NZ1 = D26NX1 + D25NY1 + D23NZ1;
        const auto D26NX2D25NY2D23NZ2 = D26NX2 + D25NY2 + D23NZ2;
        const auto D26NX3D25NY3D23NZ3 = D26NX3 + D25NY3 + D23NZ3;
        const auto D26NX4D25NY4D23NZ4 = D26NX4 + D25NY4 + D23NZ4;
        const auto D26NX5D25NY5D23NZ5 = D26NX5 + D25NY5 + D23NZ5;
        const auto D26NX6D25NY6D23NZ6 = D26NX6 + D25NY6 + D23NZ6;
        const auto D26NX7D25NY7D23NZ7 = D26NX7 + D25NY7 + D23NZ7;
        const auto D34NX1D23NY1D35NZ1 = D34NX1 + D23NY1 + D35NZ1;
        const auto D34NX2D23NY2D35NZ2 = D34NX2 + D23NY2 + D35NZ2;
        const auto D34NX3D23NY3D35NZ3 = D34NX3 + D23NY3 + D35NZ3;
        const auto D34NX4D23NY4D35NZ4 = D34NX4 + D23NY4 + D35NZ4;
        const auto D34NX5D23NY5D35NZ5 = D34NX5 + D23NY5 + D35NZ5;
        const auto D34NX6D23NY6D35NZ6 = D34NX6 + D23NY6 + D35NZ6;
        const auto D34NX7D23NY7D35NZ7 = D34NX7 + D23NY7 + D35NZ7;
        const auto D34NX8D23NY8D35NZ8 = D34NX8 + D23NY8 + D35NZ8;
        const auto D36NX1D35NY1D33NZ1 = D36NX1 + D35NY1 + D33NZ1;
        const auto D36NX2D35NY2D33NZ2 = D36NX2 + D35NY2 + D33NZ2;
        const auto D36NX3D35NY3D33NZ3 = D36NX3 + D35NY3 + D33NZ3;
        const auto D36NX4D35NY4D33NZ4 = D36NX4 + D35NY4 + D33NZ4;
        const auto D36NX5D35NY5D33NZ5 = D36NX5 + D35NY5 + D33NZ5;
        const auto D36NX6D35NY6D33NZ6 = D36NX6 + D35NY6 + D33NZ6;
        const auto D36NX7D35NY7D33NZ7 = D36NX7 + D35NY7 + D33NZ7;
        const auto D36NX8D35NY8D33NZ8 = D36NX8 + D35NY8 + D33NZ8;
        const auto D44NX1D24NY1D45NZ1 = D44NX1 + D24NY1 + D45NZ1;
        const auto D44NX2D24NY2D45NZ2 = D44NX2 + D24NY2 + D45NZ2;
        const auto D44NX3D24NY3D45NZ3 = D44NX3 + D24NY3 + D45NZ3;
        const auto D44NX4D24NY4D45NZ4 = D44NX4 + D24NY4 + D45NZ4;
        const auto D44NX5D24NY5D45NZ5 = D44NX5 + D24NY5 + D45NZ5;
        const auto D44NX6D24NY6D45NZ6 = D44NX6 + D24NY6 + D45NZ6;
        const auto D44NX7D24NY7D45NZ7 = D44NX7 + D24NY7 + D45NZ7;
        const auto D44NX8D24NY8D45NZ8 = D44NX8 + D24NY8 + D45NZ8;
        const auto D45NX1D25NY1D55NZ1 = D45NX1 + D25NY1 + D55NZ1;
        const auto D45NX2D25NY2D55NZ2 = D45NX2 + D25NY2 + D55NZ2;
        const auto D45NX3D25NY3D55NZ3 = D45NX3 + D25NY3 + D55NZ3;
        const auto D45NX4D25NY4D55NZ4 = D45NX4 + D25NY4 + D55NZ4;
        const auto D45NX5D25NY5D55NZ5 = D45NX5 + D25NY5 + D55NZ5;
        const auto D45NX6D25NY6D55NZ6 = D45NX6 + D25NY6 + D55NZ6;
        const auto D45NX7D25NY7D55NZ7 = D45NX7 + D25NY7 + D55NZ7;
        const auto D45NX8D25NY8D55NZ8 = D45NX8 + D25NY8 + D55NZ8;
        const auto D46NX1D26NY1D56NZ1 = D46NX1 + D26NY1 + D56NZ1;
        const auto D46NX1D45NY1D34NZ1 = D46NX1 + D45NY1 + D34NZ1;
        const auto D46NX2D26NY2D56NZ2 = D46NX2 + D26NY2 + D56NZ2;
        const auto D46NX2D45NY2D34NZ2 = D46NX2 + D45NY2 + D34NZ2;
        const auto D46NX3D26NY3D56NZ3 = D46NX3 + D26NY3 + D56NZ3;
        const auto D46NX3D45NY3D34NZ3 = D46NX3 + D45NY3 + D34NZ3;
        const auto D46NX4D26NY4D56NZ4 = D46NX4 + D26NY4 + D56NZ4;
        const auto D46NX4D45NY4D34NZ4 = D46NX4 + D45NY4 + D34NZ4;
        const auto D46NX5D26NY5D56NZ5 = D46NX5 + D26NY5 + D56NZ5;
        const auto D46NX5D45NY5D34NZ5 = D46NX5 + D45NY5 + D34NZ5;
        const auto D46NX6D26NY6D56NZ6 = D46NX6 + D26NY6 + D56NZ6;
        const auto D46NX6D45NY6D34NZ6 = D46NX6 + D45NY6 + D34NZ6;
        const auto D46NX7D26NY7D56NZ7 = D46NX7 + D26NY7 + D56NZ7;
        const auto D46NX7D45NY7D34NZ7 = D46NX7 + D45NY7 + D34NZ7;
        const auto D46NX8D26NY8D56NZ8 = D46NX8 + D26NY8 + D56NZ8;
        const auto D56NX1D55NY1D35NZ1 = D56NX1 + D55NY1 + D35NZ1;
        const auto D56NX2D55NY2D35NZ2 = D56NX2 + D55NY2 + D35NZ2;
        const auto D56NX3D55NY3D35NZ3 = D56NX3 + D55NY3 + D35NZ3;
        const auto D56NX4D55NY4D35NZ4 = D56NX4 + D55NY4 + D35NZ4;
        const auto D56NX5D55NY5D35NZ5 = D56NX5 + D55NY5 + D35NZ5;
        const auto D56NX6D55NY6D35NZ6 = D56NX6 + D55NY6 + D35NZ6;
        const auto D56NX7D55NY7D35NZ7 = D56NX7 + D55NY7 + D35NZ7;
        const auto D56NX8D55NY8D35NZ8 = D56NX8 + D55NY8 + D35NZ8;
        const auto D66NX1D56NY1D36NZ1 = D66NX1 + D56NY1 + D36NZ1;
        const auto D66NX2D56NY2D36NZ2 = D66NX2 + D56NY2 + D36NZ2;
        const auto D66NX3D56NY3D36NZ3 = D66NX3 + D56NY3 + D36NZ3;
        const auto D66NX4D56NY4D36NZ4 = D66NX4 + D56NY4 + D36NZ4;
        const auto D66NX5D56NY5D36NZ5 = D66NX5 + D56NY5 + D36NZ5;
        const auto D66NX6D56NY6D36NZ6 = D66NX6 + D56NY6 + D36NZ6;
        const auto D66NX7D56NY7D36NZ7 = D66NX7 + D56NY7 + D36NZ7;
        const auto D66NX8D56NY8D36NZ8 = D66NX8 + D56NY8 + D36NZ8;

        stiffness(0, 0) += NX1 * D11NX1D14NY1D16NZ1 + NY1 * D14NX1D44NY1D46NZ1 + NZ1 * D16NX1D46NY1D66NZ1;
        stiffness(0, 1) += NX1 * D14NX1D44NY1D46NZ1 + NY1 * D12NX1D24NY1D26NZ1 + NZ1 * D15NX1D45NY1D56NZ1;
        stiffness(0, 2) += NX1 * D16NX1D46NY1D66NZ1 + NY1 * D15NX1D45NY1D56NZ1 + NZ1 * D13NX1D34NY1D36NZ1;
        stiffness(0, 3) += NX2 * D11NX1D14NY1D16NZ1 + NY2 * D14NX1D44NY1D46NZ1 + NZ2 * D16NX1D46NY1D66NZ1;
        stiffness(0, 4) += NX2 * D14NX1D44NY1D46NZ1 + NY2 * D12NX1D24NY1D26NZ1 + NZ2 * D15NX1D45NY1D56NZ1;
        stiffness(0, 5) += NX2 * D16NX1D46NY1D66NZ1 + NY2 * D15NX1D45NY1D56NZ1 + NZ2 * D13NX1D34NY1D36NZ1;
        stiffness(0, 6) += NX3 * D11NX1D14NY1D16NZ1 + NY3 * D14NX1D44NY1D46NZ1 + NZ3 * D16NX1D46NY1D66NZ1;
        stiffness(0, 7) += NX3 * D14NX1D44NY1D46NZ1 + NY3 * D12NX1D24NY1D26NZ1 + NZ3 * D15NX1D45NY1D56NZ1;
        stiffness(0, 8) += NX3 * D16NX1D46NY1D66NZ1 + NY3 * D15NX1D45NY1D56NZ1 + NZ3 * D13NX1D34NY1D36NZ1;
        stiffness(0, 9) += NX4 * D11NX1D14NY1D16NZ1 + NY4 * D14NX1D44NY1D46NZ1 + NZ4 * D16NX1D46NY1D66NZ1;
        stiffness(0, 10) += NX4 * D14NX1D44NY1D46NZ1 + NY4 * D12NX1D24NY1D26NZ1 + NZ4 * D15NX1D45NY1D56NZ1;
        stiffness(0, 11) += NX4 * D16NX1D46NY1D66NZ1 + NY4 * D15NX1D45NY1D56NZ1 + NZ4 * D13NX1D34NY1D36NZ1;
        stiffness(0, 12) += NX5 * D11NX1D14NY1D16NZ1 + NY5 * D14NX1D44NY1D46NZ1 + NZ5 * D16NX1D46NY1D66NZ1;
        stiffness(0, 13) += NX5 * D14NX1D44NY1D46NZ1 + NY5 * D12NX1D24NY1D26NZ1 + NZ5 * D15NX1D45NY1D56NZ1;
        stiffness(0, 14) += NX5 * D16NX1D46NY1D66NZ1 + NY5 * D15NX1D45NY1D56NZ1 + NZ5 * D13NX1D34NY1D36NZ1;
        stiffness(0, 15) += NX6 * D11NX1D14NY1D16NZ1 + NY6 * D14NX1D44NY1D46NZ1 + NZ6 * D16NX1D46NY1D66NZ1;
        stiffness(0, 16) += NX6 * D14NX1D44NY1D46NZ1 + NY6 * D12NX1D24NY1D26NZ1 + NZ6 * D15NX1D45NY1D56NZ1;
        stiffness(0, 17) += NX6 * D16NX1D46NY1D66NZ1 + NY6 * D15NX1D45NY1D56NZ1 + NZ6 * D13NX1D34NY1D36NZ1;
        stiffness(0, 18) += NX7 * D11NX1D14NY1D16NZ1 + NY7 * D14NX1D44NY1D46NZ1 + NZ7 * D16NX1D46NY1D66NZ1;
        stiffness(0, 19) += NX7 * D14NX1D44NY1D46NZ1 + NY7 * D12NX1D24NY1D26NZ1 + NZ7 * D15NX1D45NY1D56NZ1;
        stiffness(0, 20) += NX7 * D16NX1D46NY1D66NZ1 + NY7 * D15NX1D45NY1D56NZ1 + NZ7 * D13NX1D34NY1D36NZ1;
        stiffness(0, 21) += NX8 * D11NX1D14NY1D16NZ1 + NY8 * D14NX1D44NY1D46NZ1 + NZ8 * D16NX1D46NY1D66NZ1;
        stiffness(0, 22) += NX8 * D14NX1D44NY1D46NZ1 + NY8 * D12NX1D24NY1D26NZ1 + NZ8 * D15NX1D45NY1D56NZ1;
        stiffness(0, 23) += NX8 * D16NX1D46NY1D66NZ1 + NY8 * D15NX1D45NY1D56NZ1 + NZ8 * D13NX1D34NY1D36NZ1;
        stiffness(1, 1) += NX1 * D44NX1D24NY1D45NZ1 + NY1 * D24NX1D22NY1D25NZ1 + NZ1 * D45NX1D25NY1D55NZ1;
        stiffness(1, 2) += NX1 * D46NX1D26NY1D56NZ1 + NY1 * D45NX1D25NY1D55NZ1 + NZ1 * D34NX1D23NY1D35NZ1;
        stiffness(1, 3) += NX2 * D14NX1D12NY1D15NZ1 + NY2 * D44NX1D24NY1D45NZ1 + NZ2 * D46NX1D26NY1D56NZ1;
        stiffness(1, 4) += NX2 * D44NX1D24NY1D45NZ1 + NY2 * D24NX1D22NY1D25NZ1 + NZ2 * D45NX1D25NY1D55NZ1;
        stiffness(1, 5) += NX2 * D46NX1D26NY1D56NZ1 + NY2 * D45NX1D25NY1D55NZ1 + NZ2 * D34NX1D23NY1D35NZ1;
        stiffness(1, 6) += NX3 * D14NX1D12NY1D15NZ1 + NY3 * D44NX1D24NY1D45NZ1 + NZ3 * D46NX1D26NY1D56NZ1;
        stiffness(1, 7) += NX3 * D44NX1D24NY1D45NZ1 + NY3 * D24NX1D22NY1D25NZ1 + NZ3 * D45NX1D25NY1D55NZ1;
        stiffness(1, 8) += NX3 * D46NX1D26NY1D56NZ1 + NY3 * D45NX1D25NY1D55NZ1 + NZ3 * D34NX1D23NY1D35NZ1;
        stiffness(1, 9) += NX4 * D14NX1D12NY1D15NZ1 + NY4 * D44NX1D24NY1D45NZ1 + NZ4 * D46NX1D26NY1D56NZ1;
        stiffness(1, 10) += NX4 * D44NX1D24NY1D45NZ1 + NY4 * D24NX1D22NY1D25NZ1 + NZ4 * D45NX1D25NY1D55NZ1;
        stiffness(1, 11) += NX4 * D46NX1D26NY1D56NZ1 + NY4 * D45NX1D25NY1D55NZ1 + NZ4 * D34NX1D23NY1D35NZ1;
        stiffness(1, 12) += NX5 * D14NX1D12NY1D15NZ1 + NY5 * D44NX1D24NY1D45NZ1 + NZ5 * D46NX1D26NY1D56NZ1;
        stiffness(1, 13) += NX5 * D44NX1D24NY1D45NZ1 + NY5 * D24NX1D22NY1D25NZ1 + NZ5 * D45NX1D25NY1D55NZ1;
        stiffness(1, 14) += NX5 * D46NX1D26NY1D56NZ1 + NY5 * D45NX1D25NY1D55NZ1 + NZ5 * D34NX1D23NY1D35NZ1;
        stiffness(1, 15) += NX6 * D14NX1D12NY1D15NZ1 + NY6 * D44NX1D24NY1D45NZ1 + NZ6 * D46NX1D26NY1D56NZ1;
        stiffness(1, 16) += NX6 * D44NX1D24NY1D45NZ1 + NY6 * D24NX1D22NY1D25NZ1 + NZ6 * D45NX1D25NY1D55NZ1;
        stiffness(1, 17) += NX6 * D46NX1D26NY1D56NZ1 + NY6 * D45NX1D25NY1D55NZ1 + NZ6 * D34NX1D23NY1D35NZ1;
        stiffness(1, 18) += NX7 * D14NX1D12NY1D15NZ1 + NY7 * D44NX1D24NY1D45NZ1 + NZ7 * D46NX1D26NY1D56NZ1;
        stiffness(1, 19) += NX7 * D44NX1D24NY1D45NZ1 + NY7 * D24NX1D22NY1D25NZ1 + NZ7 * D45NX1D25NY1D55NZ1;
        stiffness(1, 20) += NX7 * D46NX1D26NY1D56NZ1 + NY7 * D45NX1D25NY1D55NZ1 + NZ7 * D34NX1D23NY1D35NZ1;
        stiffness(1, 21) += NX8 * D14NX1D12NY1D15NZ1 + NY8 * D44NX1D24NY1D45NZ1 + NZ8 * D46NX1D26NY1D56NZ1;
        stiffness(1, 22) += NX8 * D44NX1D24NY1D45NZ1 + NY8 * D24NX1D22NY1D25NZ1 + NZ8 * D45NX1D25NY1D55NZ1;
        stiffness(1, 23) += NX8 * D46NX1D26NY1D56NZ1 + NY8 * D45NX1D25NY1D55NZ1 + NZ8 * D34NX1D23NY1D35NZ1;
        stiffness(2, 2) += NX1 * D66NX1D56NY1D36NZ1 + NY1 * D56NX1D55NY1D35NZ1 + NZ1 * D36NX1D35NY1D33NZ1;
        stiffness(2, 3) += NX2 * D16NX1D15NY1D13NZ1 + NY2 * D46NX1D45NY1D34NZ1 + NZ2 * D66NX1D56NY1D36NZ1;
        stiffness(2, 4) += NX2 * D46NX1D45NY1D34NZ1 + NY2 * D26NX1D25NY1D23NZ1 + NZ2 * D56NX1D55NY1D35NZ1;
        stiffness(2, 5) += NX2 * D66NX1D56NY1D36NZ1 + NY2 * D56NX1D55NY1D35NZ1 + NZ2 * D36NX1D35NY1D33NZ1;
        stiffness(2, 6) += NX3 * D16NX1D15NY1D13NZ1 + NY3 * D46NX1D45NY1D34NZ1 + NZ3 * D66NX1D56NY1D36NZ1;
        stiffness(2, 7) += NX3 * D46NX1D45NY1D34NZ1 + NY3 * D26NX1D25NY1D23NZ1 + NZ3 * D56NX1D55NY1D35NZ1;
        stiffness(2, 8) += NX3 * D66NX1D56NY1D36NZ1 + NY3 * D56NX1D55NY1D35NZ1 + NZ3 * D36NX1D35NY1D33NZ1;
        stiffness(2, 9) += NX4 * D16NX1D15NY1D13NZ1 + NY4 * D46NX1D45NY1D34NZ1 + NZ4 * D66NX1D56NY1D36NZ1;
        stiffness(2, 10) += NX4 * D46NX1D45NY1D34NZ1 + NY4 * D26NX1D25NY1D23NZ1 + NZ4 * D56NX1D55NY1D35NZ1;
        stiffness(2, 11) += NX4 * D66NX1D56NY1D36NZ1 + NY4 * D56NX1D55NY1D35NZ1 + NZ4 * D36NX1D35NY1D33NZ1;
        stiffness(2, 12) += NX5 * D16NX1D15NY1D13NZ1 + NY5 * D46NX1D45NY1D34NZ1 + NZ5 * D66NX1D56NY1D36NZ1;
        stiffness(2, 13) += NX5 * D46NX1D45NY1D34NZ1 + NY5 * D26NX1D25NY1D23NZ1 + NZ5 * D56NX1D55NY1D35NZ1;
        stiffness(2, 14) += NX5 * D66NX1D56NY1D36NZ1 + NY5 * D56NX1D55NY1D35NZ1 + NZ5 * D36NX1D35NY1D33NZ1;
        stiffness(2, 15) += NX6 * D16NX1D15NY1D13NZ1 + NY6 * D46NX1D45NY1D34NZ1 + NZ6 * D66NX1D56NY1D36NZ1;
        stiffness(2, 16) += NX6 * D46NX1D45NY1D34NZ1 + NY6 * D26NX1D25NY1D23NZ1 + NZ6 * D56NX1D55NY1D35NZ1;
        stiffness(2, 17) += NX6 * D66NX1D56NY1D36NZ1 + NY6 * D56NX1D55NY1D35NZ1 + NZ6 * D36NX1D35NY1D33NZ1;
        stiffness(2, 18) += NX7 * D16NX1D15NY1D13NZ1 + NY7 * D46NX1D45NY1D34NZ1 + NZ7 * D66NX1D56NY1D36NZ1;
        stiffness(2, 19) += NX7 * D46NX1D45NY1D34NZ1 + NY7 * D26NX1D25NY1D23NZ1 + NZ7 * D56NX1D55NY1D35NZ1;
        stiffness(2, 20) += NX7 * D66NX1D56NY1D36NZ1 + NY7 * D56NX1D55NY1D35NZ1 + NZ7 * D36NX1D35NY1D33NZ1;
        stiffness(2, 21) += NX8 * D16NX1D15NY1D13NZ1 + NY8 * D46NX1D45NY1D34NZ1 + NZ8 * D66NX1D56NY1D36NZ1;
        stiffness(2, 22) += NX8 * D46NX1D45NY1D34NZ1 + NY8 * D26NX1D25NY1D23NZ1 + NZ8 * D56NX1D55NY1D35NZ1;
        stiffness(2, 23) += NX8 * D66NX1D56NY1D36NZ1 + NY8 * D56NX1D55NY1D35NZ1 + NZ8 * D36NX1D35NY1D33NZ1;
        stiffness(3, 3) += NX2 * D11NX2D14NY2D16NZ2 + NY2 * D14NX2D44NY2D46NZ2 + NZ2 * D16NX2D46NY2D66NZ2;
        stiffness(3, 4) += NX2 * D14NX2D44NY2D46NZ2 + NY2 * D12NX2D24NY2D26NZ2 + NZ2 * D15NX2D45NY2D56NZ2;
        stiffness(3, 5) += NX2 * D16NX2D46NY2D66NZ2 + NY2 * D15NX2D45NY2D56NZ2 + NZ2 * D13NX2D34NY2D36NZ2;
        stiffness(3, 6) += NX3 * D11NX2D14NY2D16NZ2 + NY3 * D14NX2D44NY2D46NZ2 + NZ3 * D16NX2D46NY2D66NZ2;
        stiffness(3, 7) += NX3 * D14NX2D44NY2D46NZ2 + NY3 * D12NX2D24NY2D26NZ2 + NZ3 * D15NX2D45NY2D56NZ2;
        stiffness(3, 8) += NX3 * D16NX2D46NY2D66NZ2 + NY3 * D15NX2D45NY2D56NZ2 + NZ3 * D13NX2D34NY2D36NZ2;
        stiffness(3, 9) += NX4 * D11NX2D14NY2D16NZ2 + NY4 * D14NX2D44NY2D46NZ2 + NZ4 * D16NX2D46NY2D66NZ2;
        stiffness(3, 10) += NX4 * D14NX2D44NY2D46NZ2 + NY4 * D12NX2D24NY2D26NZ2 + NZ4 * D15NX2D45NY2D56NZ2;
        stiffness(3, 11) += NX4 * D16NX2D46NY2D66NZ2 + NY4 * D15NX2D45NY2D56NZ2 + NZ4 * D13NX2D34NY2D36NZ2;
        stiffness(3, 12) += NX5 * D11NX2D14NY2D16NZ2 + NY5 * D14NX2D44NY2D46NZ2 + NZ5 * D16NX2D46NY2D66NZ2;
        stiffness(3, 13) += NX5 * D14NX2D44NY2D46NZ2 + NY5 * D12NX2D24NY2D26NZ2 + NZ5 * D15NX2D45NY2D56NZ2;
        stiffness(3, 14) += NX5 * D16NX2D46NY2D66NZ2 + NY5 * D15NX2D45NY2D56NZ2 + NZ5 * D13NX2D34NY2D36NZ2;
        stiffness(3, 15) += NX6 * D11NX2D14NY2D16NZ2 + NY6 * D14NX2D44NY2D46NZ2 + NZ6 * D16NX2D46NY2D66NZ2;
        stiffness(3, 16) += NX6 * D14NX2D44NY2D46NZ2 + NY6 * D12NX2D24NY2D26NZ2 + NZ6 * D15NX2D45NY2D56NZ2;
        stiffness(3, 17) += NX6 * D16NX2D46NY2D66NZ2 + NY6 * D15NX2D45NY2D56NZ2 + NZ6 * D13NX2D34NY2D36NZ2;
        stiffness(3, 18) += NX7 * D11NX2D14NY2D16NZ2 + NY7 * D14NX2D44NY2D46NZ2 + NZ7 * D16NX2D46NY2D66NZ2;
        stiffness(3, 19) += NX7 * D14NX2D44NY2D46NZ2 + NY7 * D12NX2D24NY2D26NZ2 + NZ7 * D15NX2D45NY2D56NZ2;
        stiffness(3, 20) += NX7 * D16NX2D46NY2D66NZ2 + NY7 * D15NX2D45NY2D56NZ2 + NZ7 * D13NX2D34NY2D36NZ2;
        stiffness(3, 21) += NX8 * D11NX2D14NY2D16NZ2 + NY8 * D14NX2D44NY2D46NZ2 + NZ8 * D16NX2D46NY2D66NZ2;
        stiffness(3, 22) += NX8 * D14NX2D44NY2D46NZ2 + NY8 * D12NX2D24NY2D26NZ2 + NZ8 * D15NX2D45NY2D56NZ2;
        stiffness(3, 23) += NX8 * D16NX2D46NY2D66NZ2 + NY8 * D15NX2D45NY2D56NZ2 + NZ8 * D13NX2D34NY2D36NZ2;
        stiffness(4, 4) += NX2 * D44NX2D24NY2D45NZ2 + NY2 * D24NX2D22NY2D25NZ2 + NZ2 * D45NX2D25NY2D55NZ2;
        stiffness(4, 5) += NX2 * D46NX2D26NY2D56NZ2 + NY2 * D45NX2D25NY2D55NZ2 + NZ2 * D34NX2D23NY2D35NZ2;
        stiffness(4, 6) += NX3 * D14NX2D12NY2D15NZ2 + NY3 * D44NX2D24NY2D45NZ2 + NZ3 * D46NX2D26NY2D56NZ2;
        stiffness(4, 7) += NX3 * D44NX2D24NY2D45NZ2 + NY3 * D24NX2D22NY2D25NZ2 + NZ3 * D45NX2D25NY2D55NZ2;
        stiffness(4, 8) += NX3 * D46NX2D26NY2D56NZ2 + NY3 * D45NX2D25NY2D55NZ2 + NZ3 * D34NX2D23NY2D35NZ2;
        stiffness(4, 9) += NX4 * D14NX2D12NY2D15NZ2 + NY4 * D44NX2D24NY2D45NZ2 + NZ4 * D46NX2D26NY2D56NZ2;
        stiffness(4, 10) += NX4 * D44NX2D24NY2D45NZ2 + NY4 * D24NX2D22NY2D25NZ2 + NZ4 * D45NX2D25NY2D55NZ2;
        stiffness(4, 11) += NX4 * D46NX2D26NY2D56NZ2 + NY4 * D45NX2D25NY2D55NZ2 + NZ4 * D34NX2D23NY2D35NZ2;
        stiffness(4, 12) += NX5 * D14NX2D12NY2D15NZ2 + NY5 * D44NX2D24NY2D45NZ2 + NZ5 * D46NX2D26NY2D56NZ2;
        stiffness(4, 13) += NX5 * D44NX2D24NY2D45NZ2 + NY5 * D24NX2D22NY2D25NZ2 + NZ5 * D45NX2D25NY2D55NZ2;
        stiffness(4, 14) += NX5 * D46NX2D26NY2D56NZ2 + NY5 * D45NX2D25NY2D55NZ2 + NZ5 * D34NX2D23NY2D35NZ2;
        stiffness(4, 15) += NX6 * D14NX2D12NY2D15NZ2 + NY6 * D44NX2D24NY2D45NZ2 + NZ6 * D46NX2D26NY2D56NZ2;
        stiffness(4, 16) += NX6 * D44NX2D24NY2D45NZ2 + NY6 * D24NX2D22NY2D25NZ2 + NZ6 * D45NX2D25NY2D55NZ2;
        stiffness(4, 17) += NX6 * D46NX2D26NY2D56NZ2 + NY6 * D45NX2D25NY2D55NZ2 + NZ6 * D34NX2D23NY2D35NZ2;
        stiffness(4, 18) += NX7 * D14NX2D12NY2D15NZ2 + NY7 * D44NX2D24NY2D45NZ2 + NZ7 * D46NX2D26NY2D56NZ2;
        stiffness(4, 19) += NX7 * D44NX2D24NY2D45NZ2 + NY7 * D24NX2D22NY2D25NZ2 + NZ7 * D45NX2D25NY2D55NZ2;
        stiffness(4, 20) += NX7 * D46NX2D26NY2D56NZ2 + NY7 * D45NX2D25NY2D55NZ2 + NZ7 * D34NX2D23NY2D35NZ2;
        stiffness(4, 21) += NX8 * D14NX2D12NY2D15NZ2 + NY8 * D44NX2D24NY2D45NZ2 + NZ8 * D46NX2D26NY2D56NZ2;
        stiffness(4, 22) += NX8 * D44NX2D24NY2D45NZ2 + NY8 * D24NX2D22NY2D25NZ2 + NZ8 * D45NX2D25NY2D55NZ2;
        stiffness(4, 23) += NX8 * D46NX2D26NY2D56NZ2 + NY8 * D45NX2D25NY2D55NZ2 + NZ8 * D34NX2D23NY2D35NZ2;
        stiffness(5, 5) += NX2 * D66NX2D56NY2D36NZ2 + NY2 * D56NX2D55NY2D35NZ2 + NZ2 * D36NX2D35NY2D33NZ2;
        stiffness(5, 6) += NX3 * D16NX2D15NY2D13NZ2 + NY3 * D46NX2D45NY2D34NZ2 + NZ3 * D66NX2D56NY2D36NZ2;
        stiffness(5, 7) += NX3 * D46NX2D45NY2D34NZ2 + NY3 * D26NX2D25NY2D23NZ2 + NZ3 * D56NX2D55NY2D35NZ2;
        stiffness(5, 8) += NX3 * D66NX2D56NY2D36NZ2 + NY3 * D56NX2D55NY2D35NZ2 + NZ3 * D36NX2D35NY2D33NZ2;
        stiffness(5, 9) += NX4 * D16NX2D15NY2D13NZ2 + NY4 * D46NX2D45NY2D34NZ2 + NZ4 * D66NX2D56NY2D36NZ2;
        stiffness(5, 10) += NX4 * D46NX2D45NY2D34NZ2 + NY4 * D26NX2D25NY2D23NZ2 + NZ4 * D56NX2D55NY2D35NZ2;
        stiffness(5, 11) += NX4 * D66NX2D56NY2D36NZ2 + NY4 * D56NX2D55NY2D35NZ2 + NZ4 * D36NX2D35NY2D33NZ2;
        stiffness(5, 12) += NX5 * D16NX2D15NY2D13NZ2 + NY5 * D46NX2D45NY2D34NZ2 + NZ5 * D66NX2D56NY2D36NZ2;
        stiffness(5, 13) += NX5 * D46NX2D45NY2D34NZ2 + NY5 * D26NX2D25NY2D23NZ2 + NZ5 * D56NX2D55NY2D35NZ2;
        stiffness(5, 14) += NX5 * D66NX2D56NY2D36NZ2 + NY5 * D56NX2D55NY2D35NZ2 + NZ5 * D36NX2D35NY2D33NZ2;
        stiffness(5, 15) += NX6 * D16NX2D15NY2D13NZ2 + NY6 * D46NX2D45NY2D34NZ2 + NZ6 * D66NX2D56NY2D36NZ2;
        stiffness(5, 16) += NX6 * D46NX2D45NY2D34NZ2 + NY6 * D26NX2D25NY2D23NZ2 + NZ6 * D56NX2D55NY2D35NZ2;
        stiffness(5, 17) += NX6 * D66NX2D56NY2D36NZ2 + NY6 * D56NX2D55NY2D35NZ2 + NZ6 * D36NX2D35NY2D33NZ2;
        stiffness(5, 18) += NX7 * D16NX2D15NY2D13NZ2 + NY7 * D46NX2D45NY2D34NZ2 + NZ7 * D66NX2D56NY2D36NZ2;
        stiffness(5, 19) += NX7 * D46NX2D45NY2D34NZ2 + NY7 * D26NX2D25NY2D23NZ2 + NZ7 * D56NX2D55NY2D35NZ2;
        stiffness(5, 20) += NX7 * D66NX2D56NY2D36NZ2 + NY7 * D56NX2D55NY2D35NZ2 + NZ7 * D36NX2D35NY2D33NZ2;
        stiffness(5, 21) += NX8 * D16NX2D15NY2D13NZ2 + NY8 * D46NX2D45NY2D34NZ2 + NZ8 * D66NX2D56NY2D36NZ2;
        stiffness(5, 22) += NX8 * D46NX2D45NY2D34NZ2 + NY8 * D26NX2D25NY2D23NZ2 + NZ8 * D56NX2D55NY2D35NZ2;
        stiffness(5, 23) += NX8 * D66NX2D56NY2D36NZ2 + NY8 * D56NX2D55NY2D35NZ2 + NZ8 * D36NX2D35NY2D33NZ2;
        stiffness(6, 6) += NX3 * D11NX3D14NY3D16NZ3 + NY3 * D14NX3D44NY3D46NZ3 + NZ3 * D16NX3D46NY3D66NZ3;
        stiffness(6, 7) += NX3 * D14NX3D44NY3D46NZ3 + NY3 * D12NX3D24NY3D26NZ3 + NZ3 * D15NX3D45NY3D56NZ3;
        stiffness(6, 8) += NX3 * D16NX3D46NY3D66NZ3 + NY3 * D15NX3D45NY3D56NZ3 + NZ3 * D13NX3D34NY3D36NZ3;
        stiffness(6, 9) += NX4 * D11NX3D14NY3D16NZ3 + NY4 * D14NX3D44NY3D46NZ3 + NZ4 * D16NX3D46NY3D66NZ3;
        stiffness(6, 10) += NX4 * D14NX3D44NY3D46NZ3 + NY4 * D12NX3D24NY3D26NZ3 + NZ4 * D15NX3D45NY3D56NZ3;
        stiffness(6, 11) += NX4 * D16NX3D46NY3D66NZ3 + NY4 * D15NX3D45NY3D56NZ3 + NZ4 * D13NX3D34NY3D36NZ3;
        stiffness(6, 12) += NX5 * D11NX3D14NY3D16NZ3 + NY5 * D14NX3D44NY3D46NZ3 + NZ5 * D16NX3D46NY3D66NZ3;
        stiffness(6, 13) += NX5 * D14NX3D44NY3D46NZ3 + NY5 * D12NX3D24NY3D26NZ3 + NZ5 * D15NX3D45NY3D56NZ3;
        stiffness(6, 14) += NX5 * D16NX3D46NY3D66NZ3 + NY5 * D15NX3D45NY3D56NZ3 + NZ5 * D13NX3D34NY3D36NZ3;
        stiffness(6, 15) += NX6 * D11NX3D14NY3D16NZ3 + NY6 * D14NX3D44NY3D46NZ3 + NZ6 * D16NX3D46NY3D66NZ3;
        stiffness(6, 16) += NX6 * D14NX3D44NY3D46NZ3 + NY6 * D12NX3D24NY3D26NZ3 + NZ6 * D15NX3D45NY3D56NZ3;
        stiffness(6, 17) += NX6 * D16NX3D46NY3D66NZ3 + NY6 * D15NX3D45NY3D56NZ3 + NZ6 * D13NX3D34NY3D36NZ3;
        stiffness(6, 18) += NX7 * D11NX3D14NY3D16NZ3 + NY7 * D14NX3D44NY3D46NZ3 + NZ7 * D16NX3D46NY3D66NZ3;
        stiffness(6, 19) += NX7 * D14NX3D44NY3D46NZ3 + NY7 * D12NX3D24NY3D26NZ3 + NZ7 * D15NX3D45NY3D56NZ3;
        stiffness(6, 20) += NX7 * D16NX3D46NY3D66NZ3 + NY7 * D15NX3D45NY3D56NZ3 + NZ7 * D13NX3D34NY3D36NZ3;
        stiffness(6, 21) += NX8 * D11NX3D14NY3D16NZ3 + NY8 * D14NX3D44NY3D46NZ3 + NZ8 * D16NX3D46NY3D66NZ3;
        stiffness(6, 22) += NX8 * D14NX3D44NY3D46NZ3 + NY8 * D12NX3D24NY3D26NZ3 + NZ8 * D15NX3D45NY3D56NZ3;
        stiffness(6, 23) += NX8 * D16NX3D46NY3D66NZ3 + NY8 * D15NX3D45NY3D56NZ3 + NZ8 * D13NX3D34NY3D36NZ3;
        stiffness(7, 7) += NX3 * D44NX3D24NY3D45NZ3 + NY3 * D24NX3D22NY3D25NZ3 + NZ3 * D45NX3D25NY3D55NZ3;
        stiffness(7, 8) += NX3 * D46NX3D26NY3D56NZ3 + NY3 * D45NX3D25NY3D55NZ3 + NZ3 * D34NX3D23NY3D35NZ3;
        stiffness(7, 9) += NX4 * D14NX3D12NY3D15NZ3 + NY4 * D44NX3D24NY3D45NZ3 + NZ4 * D46NX3D26NY3D56NZ3;
        stiffness(7, 10) += NX4 * D44NX3D24NY3D45NZ3 + NY4 * D24NX3D22NY3D25NZ3 + NZ4 * D45NX3D25NY3D55NZ3;
        stiffness(7, 11) += NX4 * D46NX3D26NY3D56NZ3 + NY4 * D45NX3D25NY3D55NZ3 + NZ4 * D34NX3D23NY3D35NZ3;
        stiffness(7, 12) += NX5 * D14NX3D12NY3D15NZ3 + NY5 * D44NX3D24NY3D45NZ3 + NZ5 * D46NX3D26NY3D56NZ3;
        stiffness(7, 13) += NX5 * D44NX3D24NY3D45NZ3 + NY5 * D24NX3D22NY3D25NZ3 + NZ5 * D45NX3D25NY3D55NZ3;
        stiffness(7, 14) += NX5 * D46NX3D26NY3D56NZ3 + NY5 * D45NX3D25NY3D55NZ3 + NZ5 * D34NX3D23NY3D35NZ3;
        stiffness(7, 15) += NX6 * D14NX3D12NY3D15NZ3 + NY6 * D44NX3D24NY3D45NZ3 + NZ6 * D46NX3D26NY3D56NZ3;
        stiffness(7, 16) += NX6 * D44NX3D24NY3D45NZ3 + NY6 * D24NX3D22NY3D25NZ3 + NZ6 * D45NX3D25NY3D55NZ3;
        stiffness(7, 17) += NX6 * D46NX3D26NY3D56NZ3 + NY6 * D45NX3D25NY3D55NZ3 + NZ6 * D34NX3D23NY3D35NZ3;
        stiffness(7, 18) += NX7 * D14NX3D12NY3D15NZ3 + NY7 * D44NX3D24NY3D45NZ3 + NZ7 * D46NX3D26NY3D56NZ3;
        stiffness(7, 19) += NX7 * D44NX3D24NY3D45NZ3 + NY7 * D24NX3D22NY3D25NZ3 + NZ7 * D45NX3D25NY3D55NZ3;
        stiffness(7, 20) += NX7 * D46NX3D26NY3D56NZ3 + NY7 * D45NX3D25NY3D55NZ3 + NZ7 * D34NX3D23NY3D35NZ3;
        stiffness(7, 21) += NX8 * D14NX3D12NY3D15NZ3 + NY8 * D44NX3D24NY3D45NZ3 + NZ8 * D46NX3D26NY3D56NZ3;
        stiffness(7, 22) += NX8 * D44NX3D24NY3D45NZ3 + NY8 * D24NX3D22NY3D25NZ3 + NZ8 * D45NX3D25NY3D55NZ3;
        stiffness(7, 23) += NX8 * D46NX3D26NY3D56NZ3 + NY8 * D45NX3D25NY3D55NZ3 + NZ8 * D34NX3D23NY3D35NZ3;
        stiffness(8, 8) += NX3 * D66NX3D56NY3D36NZ3 + NY3 * D56NX3D55NY3D35NZ3 + NZ3 * D36NX3D35NY3D33NZ3;
        stiffness(8, 9) += NX4 * D16NX3D15NY3D13NZ3 + NY4 * D46NX3D45NY3D34NZ3 + NZ4 * D66NX3D56NY3D36NZ3;
        stiffness(8, 10) += NX4 * D46NX3D45NY3D34NZ3 + NY4 * D26NX3D25NY3D23NZ3 + NZ4 * D56NX3D55NY3D35NZ3;
        stiffness(8, 11) += NX4 * D66NX3D56NY3D36NZ3 + NY4 * D56NX3D55NY3D35NZ3 + NZ4 * D36NX3D35NY3D33NZ3;
        stiffness(8, 12) += NX5 * D16NX3D15NY3D13NZ3 + NY5 * D46NX3D45NY3D34NZ3 + NZ5 * D66NX3D56NY3D36NZ3;
        stiffness(8, 13) += NX5 * D46NX3D45NY3D34NZ3 + NY5 * D26NX3D25NY3D23NZ3 + NZ5 * D56NX3D55NY3D35NZ3;
        stiffness(8, 14) += NX5 * D66NX3D56NY3D36NZ3 + NY5 * D56NX3D55NY3D35NZ3 + NZ5 * D36NX3D35NY3D33NZ3;
        stiffness(8, 15) += NX6 * D16NX3D15NY3D13NZ3 + NY6 * D46NX3D45NY3D34NZ3 + NZ6 * D66NX3D56NY3D36NZ3;
        stiffness(8, 16) += NX6 * D46NX3D45NY3D34NZ3 + NY6 * D26NX3D25NY3D23NZ3 + NZ6 * D56NX3D55NY3D35NZ3;
        stiffness(8, 17) += NX6 * D66NX3D56NY3D36NZ3 + NY6 * D56NX3D55NY3D35NZ3 + NZ6 * D36NX3D35NY3D33NZ3;
        stiffness(8, 18) += NX7 * D16NX3D15NY3D13NZ3 + NY7 * D46NX3D45NY3D34NZ3 + NZ7 * D66NX3D56NY3D36NZ3;
        stiffness(8, 19) += NX7 * D46NX3D45NY3D34NZ3 + NY7 * D26NX3D25NY3D23NZ3 + NZ7 * D56NX3D55NY3D35NZ3;
        stiffness(8, 20) += NX7 * D66NX3D56NY3D36NZ3 + NY7 * D56NX3D55NY3D35NZ3 + NZ7 * D36NX3D35NY3D33NZ3;
        stiffness(8, 21) += NX8 * D16NX3D15NY3D13NZ3 + NY8 * D46NX3D45NY3D34NZ3 + NZ8 * D66NX3D56NY3D36NZ3;
        stiffness(8, 22) += NX8 * D46NX3D45NY3D34NZ3 + NY8 * D26NX3D25NY3D23NZ3 + NZ8 * D56NX3D55NY3D35NZ3;
        stiffness(8, 23) += NX8 * D66NX3D56NY3D36NZ3 + NY8 * D56NX3D55NY3D35NZ3 + NZ8 * D36NX3D35NY3D33NZ3;
        stiffness(9, 9) += NX4 * D11NX4D14NY4D16NZ4 + NY4 * D14NX4D44NY4D46NZ4 + NZ4 * D16NX4D46NY4D66NZ4;
        stiffness(9, 10) += NX4 * D14NX4D44NY4D46NZ4 + NY4 * D12NX4D24NY4D26NZ4 + NZ4 * D15NX4D45NY4D56NZ4;
        stiffness(9, 11) += NX4 * D16NX4D46NY4D66NZ4 + NY4 * D15NX4D45NY4D56NZ4 + NZ4 * D13NX4D34NY4D36NZ4;
        stiffness(9, 12) += NX5 * D11NX4D14NY4D16NZ4 + NY5 * D14NX4D44NY4D46NZ4 + NZ5 * D16NX4D46NY4D66NZ4;
        stiffness(9, 13) += NX5 * D14NX4D44NY4D46NZ4 + NY5 * D12NX4D24NY4D26NZ4 + NZ5 * D15NX4D45NY4D56NZ4;
        stiffness(9, 14) += NX5 * D16NX4D46NY4D66NZ4 + NY5 * D15NX4D45NY4D56NZ4 + NZ5 * D13NX4D34NY4D36NZ4;
        stiffness(9, 15) += NX6 * D11NX4D14NY4D16NZ4 + NY6 * D14NX4D44NY4D46NZ4 + NZ6 * D16NX4D46NY4D66NZ4;
        stiffness(9, 16) += NX6 * D14NX4D44NY4D46NZ4 + NY6 * D12NX4D24NY4D26NZ4 + NZ6 * D15NX4D45NY4D56NZ4;
        stiffness(9, 17) += NX6 * D16NX4D46NY4D66NZ4 + NY6 * D15NX4D45NY4D56NZ4 + NZ6 * D13NX4D34NY4D36NZ4;
        stiffness(9, 18) += NX7 * D11NX4D14NY4D16NZ4 + NY7 * D14NX4D44NY4D46NZ4 + NZ7 * D16NX4D46NY4D66NZ4;
        stiffness(9, 19) += NX7 * D14NX4D44NY4D46NZ4 + NY7 * D12NX4D24NY4D26NZ4 + NZ7 * D15NX4D45NY4D56NZ4;
        stiffness(9, 20) += NX7 * D16NX4D46NY4D66NZ4 + NY7 * D15NX4D45NY4D56NZ4 + NZ7 * D13NX4D34NY4D36NZ4;
        stiffness(9, 21) += NX8 * D11NX4D14NY4D16NZ4 + NY8 * D14NX4D44NY4D46NZ4 + NZ8 * D16NX4D46NY4D66NZ4;
        stiffness(9, 22) += NX8 * D14NX4D44NY4D46NZ4 + NY8 * D12NX4D24NY4D26NZ4 + NZ8 * D15NX4D45NY4D56NZ4;
        stiffness(9, 23) += NX8 * D16NX4D46NY4D66NZ4 + NY8 * D15NX4D45NY4D56NZ4 + NZ8 * D13NX4D34NY4D36NZ4;
        stiffness(10, 10) += NX4 * D44NX4D24NY4D45NZ4 + NY4 * D24NX4D22NY4D25NZ4 + NZ4 * D45NX4D25NY4D55NZ4;
        stiffness(10, 11) += NX4 * D46NX4D26NY4D56NZ4 + NY4 * D45NX4D25NY4D55NZ4 + NZ4 * D34NX4D23NY4D35NZ4;
        stiffness(10, 12) += NX5 * D14NX4D12NY4D15NZ4 + NY5 * D44NX4D24NY4D45NZ4 + NZ5 * D46NX4D26NY4D56NZ4;
        stiffness(10, 13) += NX5 * D44NX4D24NY4D45NZ4 + NY5 * D24NX4D22NY4D25NZ4 + NZ5 * D45NX4D25NY4D55NZ4;
        stiffness(10, 14) += NX5 * D46NX4D26NY4D56NZ4 + NY5 * D45NX4D25NY4D55NZ4 + NZ5 * D34NX4D23NY4D35NZ4;
        stiffness(10, 15) += NX6 * D14NX4D12NY4D15NZ4 + NY6 * D44NX4D24NY4D45NZ4 + NZ6 * D46NX4D26NY4D56NZ4;
        stiffness(10, 16) += NX6 * D44NX4D24NY4D45NZ4 + NY6 * D24NX4D22NY4D25NZ4 + NZ6 * D45NX4D25NY4D55NZ4;
        stiffness(10, 17) += NX6 * D46NX4D26NY4D56NZ4 + NY6 * D45NX4D25NY4D55NZ4 + NZ6 * D34NX4D23NY4D35NZ4;
        stiffness(10, 18) += NX7 * D14NX4D12NY4D15NZ4 + NY7 * D44NX4D24NY4D45NZ4 + NZ7 * D46NX4D26NY4D56NZ4;
        stiffness(10, 19) += NX7 * D44NX4D24NY4D45NZ4 + NY7 * D24NX4D22NY4D25NZ4 + NZ7 * D45NX4D25NY4D55NZ4;
        stiffness(10, 20) += NX7 * D46NX4D26NY4D56NZ4 + NY7 * D45NX4D25NY4D55NZ4 + NZ7 * D34NX4D23NY4D35NZ4;
        stiffness(10, 21) += NX8 * D14NX4D12NY4D15NZ4 + NY8 * D44NX4D24NY4D45NZ4 + NZ8 * D46NX4D26NY4D56NZ4;
        stiffness(10, 22) += NX8 * D44NX4D24NY4D45NZ4 + NY8 * D24NX4D22NY4D25NZ4 + NZ8 * D45NX4D25NY4D55NZ4;
        stiffness(10, 23) += NX8 * D46NX4D26NY4D56NZ4 + NY8 * D45NX4D25NY4D55NZ4 + NZ8 * D34NX4D23NY4D35NZ4;
        stiffness(11, 11) += NX4 * D66NX4D56NY4D36NZ4 + NY4 * D56NX4D55NY4D35NZ4 + NZ4 * D36NX4D35NY4D33NZ4;
        stiffness(11, 12) += NX5 * D16NX4D15NY4D13NZ4 + NY5 * D46NX4D45NY4D34NZ4 + NZ5 * D66NX4D56NY4D36NZ4;
        stiffness(11, 13) += NX5 * D46NX4D45NY4D34NZ4 + NY5 * D26NX4D25NY4D23NZ4 + NZ5 * D56NX4D55NY4D35NZ4;
        stiffness(11, 14) += NX5 * D66NX4D56NY4D36NZ4 + NY5 * D56NX4D55NY4D35NZ4 + NZ5 * D36NX4D35NY4D33NZ4;
        stiffness(11, 15) += NX6 * D16NX4D15NY4D13NZ4 + NY6 * D46NX4D45NY4D34NZ4 + NZ6 * D66NX4D56NY4D36NZ4;
        stiffness(11, 16) += NX6 * D46NX4D45NY4D34NZ4 + NY6 * D26NX4D25NY4D23NZ4 + NZ6 * D56NX4D55NY4D35NZ4;
        stiffness(11, 17) += NX6 * D66NX4D56NY4D36NZ4 + NY6 * D56NX4D55NY4D35NZ4 + NZ6 * D36NX4D35NY4D33NZ4;
        stiffness(11, 18) += NX7 * D16NX4D15NY4D13NZ4 + NY7 * D46NX4D45NY4D34NZ4 + NZ7 * D66NX4D56NY4D36NZ4;
        stiffness(11, 19) += NX7 * D46NX4D45NY4D34NZ4 + NY7 * D26NX4D25NY4D23NZ4 + NZ7 * D56NX4D55NY4D35NZ4;
        stiffness(11, 20) += NX7 * D66NX4D56NY4D36NZ4 + NY7 * D56NX4D55NY4D35NZ4 + NZ7 * D36NX4D35NY4D33NZ4;
        stiffness(11, 21) += NX8 * D16NX4D15NY4D13NZ4 + NY8 * D46NX4D45NY4D34NZ4 + NZ8 * D66NX4D56NY4D36NZ4;
        stiffness(11, 22) += NX8 * D46NX4D45NY4D34NZ4 + NY8 * D26NX4D25NY4D23NZ4 + NZ8 * D56NX4D55NY4D35NZ4;
        stiffness(11, 23) += NX8 * D66NX4D56NY4D36NZ4 + NY8 * D56NX4D55NY4D35NZ4 + NZ8 * D36NX4D35NY4D33NZ4;
        stiffness(12, 12) += NX5 * D11NX5D14NY5D16NZ5 + NY5 * D14NX5D44NY5D46NZ5 + NZ5 * D16NX5D46NY5D66NZ5;
        stiffness(12, 13) += NX5 * D14NX5D44NY5D46NZ5 + NY5 * D12NX5D24NY5D26NZ5 + NZ5 * D15NX5D45NY5D56NZ5;
        stiffness(12, 14) += NX5 * D16NX5D46NY5D66NZ5 + NY5 * D15NX5D45NY5D56NZ5 + NZ5 * D13NX5D34NY5D36NZ5;
        stiffness(12, 15) += NX6 * D11NX5D14NY5D16NZ5 + NY6 * D14NX5D44NY5D46NZ5 + NZ6 * D16NX5D46NY5D66NZ5;
        stiffness(12, 16) += NX6 * D14NX5D44NY5D46NZ5 + NY6 * D12NX5D24NY5D26NZ5 + NZ6 * D15NX5D45NY5D56NZ5;
        stiffness(12, 17) += NX6 * D16NX5D46NY5D66NZ5 + NY6 * D15NX5D45NY5D56NZ5 + NZ6 * D13NX5D34NY5D36NZ5;
        stiffness(12, 18) += NX7 * D11NX5D14NY5D16NZ5 + NY7 * D14NX5D44NY5D46NZ5 + NZ7 * D16NX5D46NY5D66NZ5;
        stiffness(12, 19) += NX7 * D14NX5D44NY5D46NZ5 + NY7 * D12NX5D24NY5D26NZ5 + NZ7 * D15NX5D45NY5D56NZ5;
        stiffness(12, 20) += NX7 * D16NX5D46NY5D66NZ5 + NY7 * D15NX5D45NY5D56NZ5 + NZ7 * D13NX5D34NY5D36NZ5;
        stiffness(12, 21) += NX8 * D11NX5D14NY5D16NZ5 + NY8 * D14NX5D44NY5D46NZ5 + NZ8 * D16NX5D46NY5D66NZ5;
        stiffness(12, 22) += NX8 * D14NX5D44NY5D46NZ5 + NY8 * D12NX5D24NY5D26NZ5 + NZ8 * D15NX5D45NY5D56NZ5;
        stiffness(12, 23) += NX8 * D16NX5D46NY5D66NZ5 + NY8 * D15NX5D45NY5D56NZ5 + NZ8 * D13NX5D34NY5D36NZ5;
        stiffness(13, 13) += NX5 * D44NX5D24NY5D45NZ5 + NY5 * D24NX5D22NY5D25NZ5 + NZ5 * D45NX5D25NY5D55NZ5;
        stiffness(13, 14) += NX5 * D46NX5D26NY5D56NZ5 + NY5 * D45NX5D25NY5D55NZ5 + NZ5 * D34NX5D23NY5D35NZ5;
        stiffness(13, 15) += NX6 * D14NX5D12NY5D15NZ5 + NY6 * D44NX5D24NY5D45NZ5 + NZ6 * D46NX5D26NY5D56NZ5;
        stiffness(13, 16) += NX6 * D44NX5D24NY5D45NZ5 + NY6 * D24NX5D22NY5D25NZ5 + NZ6 * D45NX5D25NY5D55NZ5;
        stiffness(13, 17) += NX6 * D46NX5D26NY5D56NZ5 + NY6 * D45NX5D25NY5D55NZ5 + NZ6 * D34NX5D23NY5D35NZ5;
        stiffness(13, 18) += NX7 * D14NX5D12NY5D15NZ5 + NY7 * D44NX5D24NY5D45NZ5 + NZ7 * D46NX5D26NY5D56NZ5;
        stiffness(13, 19) += NX7 * D44NX5D24NY5D45NZ5 + NY7 * D24NX5D22NY5D25NZ5 + NZ7 * D45NX5D25NY5D55NZ5;
        stiffness(13, 20) += NX7 * D46NX5D26NY5D56NZ5 + NY7 * D45NX5D25NY5D55NZ5 + NZ7 * D34NX5D23NY5D35NZ5;
        stiffness(13, 21) += NX8 * D14NX5D12NY5D15NZ5 + NY8 * D44NX5D24NY5D45NZ5 + NZ8 * D46NX5D26NY5D56NZ5;
        stiffness(13, 22) += NX8 * D44NX5D24NY5D45NZ5 + NY8 * D24NX5D22NY5D25NZ5 + NZ8 * D45NX5D25NY5D55NZ5;
        stiffness(13, 23) += NX8 * D46NX5D26NY5D56NZ5 + NY8 * D45NX5D25NY5D55NZ5 + NZ8 * D34NX5D23NY5D35NZ5;
        stiffness(14, 14) += NX5 * D66NX5D56NY5D36NZ5 + NY5 * D56NX5D55NY5D35NZ5 + NZ5 * D36NX5D35NY5D33NZ5;
        stiffness(14, 15) += NX6 * D16NX5D15NY5D13NZ5 + NY6 * D46NX5D45NY5D34NZ5 + NZ6 * D66NX5D56NY5D36NZ5;
        stiffness(14, 16) += NX6 * D46NX5D45NY5D34NZ5 + NY6 * D26NX5D25NY5D23NZ5 + NZ6 * D56NX5D55NY5D35NZ5;
        stiffness(14, 17) += NX6 * D66NX5D56NY5D36NZ5 + NY6 * D56NX5D55NY5D35NZ5 + NZ6 * D36NX5D35NY5D33NZ5;
        stiffness(14, 18) += NX7 * D16NX5D15NY5D13NZ5 + NY7 * D46NX5D45NY5D34NZ5 + NZ7 * D66NX5D56NY5D36NZ5;
        stiffness(14, 19) += NX7 * D46NX5D45NY5D34NZ5 + NY7 * D26NX5D25NY5D23NZ5 + NZ7 * D56NX5D55NY5D35NZ5;
        stiffness(14, 20) += NX7 * D66NX5D56NY5D36NZ5 + NY7 * D56NX5D55NY5D35NZ5 + NZ7 * D36NX5D35NY5D33NZ5;
        stiffness(14, 21) += NX8 * D16NX5D15NY5D13NZ5 + NY8 * D46NX5D45NY5D34NZ5 + NZ8 * D66NX5D56NY5D36NZ5;
        stiffness(14, 22) += NX8 * D46NX5D45NY5D34NZ5 + NY8 * D26NX5D25NY5D23NZ5 + NZ8 * D56NX5D55NY5D35NZ5;
        stiffness(14, 23) += NX8 * D66NX5D56NY5D36NZ5 + NY8 * D56NX5D55NY5D35NZ5 + NZ8 * D36NX5D35NY5D33NZ5;
        stiffness(15, 15) += NX6 * D11NX6D14NY6D16NZ6 + NY6 * D14NX6D44NY6D46NZ6 + NZ6 * D16NX6D46NY6D66NZ6;
        stiffness(15, 16) += NX6 * D14NX6D44NY6D46NZ6 + NY6 * D12NX6D24NY6D26NZ6 + NZ6 * D15NX6D45NY6D56NZ6;
        stiffness(15, 17) += NX6 * D16NX6D46NY6D66NZ6 + NY6 * D15NX6D45NY6D56NZ6 + NZ6 * D13NX6D34NY6D36NZ6;
        stiffness(15, 18) += NX7 * D11NX6D14NY6D16NZ6 + NY7 * D14NX6D44NY6D46NZ6 + NZ7 * D16NX6D46NY6D66NZ6;
        stiffness(15, 19) += NX7 * D14NX6D44NY6D46NZ6 + NY7 * D12NX6D24NY6D26NZ6 + NZ7 * D15NX6D45NY6D56NZ6;
        stiffness(15, 20) += NX7 * D16NX6D46NY6D66NZ6 + NY7 * D15NX6D45NY6D56NZ6 + NZ7 * D13NX6D34NY6D36NZ6;
        stiffness(15, 21) += NX8 * D11NX6D14NY6D16NZ6 + NY8 * D14NX6D44NY6D46NZ6 + NZ8 * D16NX6D46NY6D66NZ6;
        stiffness(15, 22) += NX8 * D14NX6D44NY6D46NZ6 + NY8 * D12NX6D24NY6D26NZ6 + NZ8 * D15NX6D45NY6D56NZ6;
        stiffness(15, 23) += NX8 * D16NX6D46NY6D66NZ6 + NY8 * D15NX6D45NY6D56NZ6 + NZ8 * D13NX6D34NY6D36NZ6;
        stiffness(16, 16) += NX6 * D44NX6D24NY6D45NZ6 + NY6 * D24NX6D22NY6D25NZ6 + NZ6 * D45NX6D25NY6D55NZ6;
        stiffness(16, 17) += NX6 * D46NX6D26NY6D56NZ6 + NY6 * D45NX6D25NY6D55NZ6 + NZ6 * D34NX6D23NY6D35NZ6;
        stiffness(16, 18) += NX7 * D14NX6D12NY6D15NZ6 + NY7 * D44NX6D24NY6D45NZ6 + NZ7 * D46NX6D26NY6D56NZ6;
        stiffness(16, 19) += NX7 * D44NX6D24NY6D45NZ6 + NY7 * D24NX6D22NY6D25NZ6 + NZ7 * D45NX6D25NY6D55NZ6;
        stiffness(16, 20) += NX7 * D46NX6D26NY6D56NZ6 + NY7 * D45NX6D25NY6D55NZ6 + NZ7 * D34NX6D23NY6D35NZ6;
        stiffness(16, 21) += NX8 * D14NX6D12NY6D15NZ6 + NY8 * D44NX6D24NY6D45NZ6 + NZ8 * D46NX6D26NY6D56NZ6;
        stiffness(16, 22) += NX8 * D44NX6D24NY6D45NZ6 + NY8 * D24NX6D22NY6D25NZ6 + NZ8 * D45NX6D25NY6D55NZ6;
        stiffness(16, 23) += NX8 * D46NX6D26NY6D56NZ6 + NY8 * D45NX6D25NY6D55NZ6 + NZ8 * D34NX6D23NY6D35NZ6;
        stiffness(17, 17) += NX6 * D66NX6D56NY6D36NZ6 + NY6 * D56NX6D55NY6D35NZ6 + NZ6 * D36NX6D35NY6D33NZ6;
        stiffness(17, 18) += NX7 * D16NX6D15NY6D13NZ6 + NY7 * D46NX6D45NY6D34NZ6 + NZ7 * D66NX6D56NY6D36NZ6;
        stiffness(17, 19) += NX7 * D46NX6D45NY6D34NZ6 + NY7 * D26NX6D25NY6D23NZ6 + NZ7 * D56NX6D55NY6D35NZ6;
        stiffness(17, 20) += NX7 * D66NX6D56NY6D36NZ6 + NY7 * D56NX6D55NY6D35NZ6 + NZ7 * D36NX6D35NY6D33NZ6;
        stiffness(17, 21) += NX8 * D16NX6D15NY6D13NZ6 + NY8 * D46NX6D45NY6D34NZ6 + NZ8 * D66NX6D56NY6D36NZ6;
        stiffness(17, 22) += NX8 * D46NX6D45NY6D34NZ6 + NY8 * D26NX6D25NY6D23NZ6 + NZ8 * D56NX6D55NY6D35NZ6;
        stiffness(17, 23) += NX8 * D66NX6D56NY6D36NZ6 + NY8 * D56NX6D55NY6D35NZ6 + NZ8 * D36NX6D35NY6D33NZ6;
        stiffness(18, 18) += NX7 * D11NX7D14NY7D16NZ7 + NY7 * D14NX7D44NY7D46NZ7 + NZ7 * D16NX7D46NY7D66NZ7;
        stiffness(18, 19) += NX7 * D14NX7D44NY7D46NZ7 + NY7 * D12NX7D24NY7D26NZ7 + NZ7 * D15NX7D45NY7D56NZ7;
        stiffness(18, 20) += NX7 * D16NX7D46NY7D66NZ7 + NY7 * D15NX7D45NY7D56NZ7 + NZ7 * D13NX7D34NY7D36NZ7;
        stiffness(18, 21) += NX8 * D11NX7D14NY7D16NZ7 + NY8 * D14NX7D44NY7D46NZ7 + NZ8 * D16NX7D46NY7D66NZ7;
        stiffness(18, 22) += NX8 * D14NX7D44NY7D46NZ7 + NY8 * D12NX7D24NY7D26NZ7 + NZ8 * D15NX7D45NY7D56NZ7;
        stiffness(18, 23) += NX8 * D16NX7D46NY7D66NZ7 + NY8 * D15NX7D45NY7D56NZ7 + NZ8 * D13NX7D34NY7D36NZ7;
        stiffness(19, 19) += NX7 * D44NX7D24NY7D45NZ7 + NY7 * D24NX7D22NY7D25NZ7 + NZ7 * D45NX7D25NY7D55NZ7;
        stiffness(19, 20) += NX7 * D46NX7D26NY7D56NZ7 + NY7 * D45NX7D25NY7D55NZ7 + NZ7 * D34NX7D23NY7D35NZ7;
        stiffness(19, 21) += NX8 * D14NX7D12NY7D15NZ7 + NY8 * D44NX7D24NY7D45NZ7 + NZ8 * D46NX7D26NY7D56NZ7;
        stiffness(19, 22) += NX8 * D44NX7D24NY7D45NZ7 + NY8 * D24NX7D22NY7D25NZ7 + NZ8 * D45NX7D25NY7D55NZ7;
        stiffness(19, 23) += NX8 * D46NX7D26NY7D56NZ7 + NY8 * D45NX7D25NY7D55NZ7 + NZ8 * D34NX7D23NY7D35NZ7;
        stiffness(20, 20) += NX7 * D66NX7D56NY7D36NZ7 + NY7 * D56NX7D55NY7D35NZ7 + NZ7 * D36NX7D35NY7D33NZ7;
        stiffness(20, 21) += NX8 * D16NX7D15NY7D13NZ7 + NY8 * D46NX7D45NY7D34NZ7 + NZ8 * D66NX7D56NY7D36NZ7;
        stiffness(20, 22) += NX8 * D46NX7D45NY7D34NZ7 + NY8 * D26NX7D25NY7D23NZ7 + NZ8 * D56NX7D55NY7D35NZ7;
        stiffness(20, 23) += NX8 * D66NX7D56NY7D36NZ7 + NY8 * D56NX7D55NY7D35NZ7 + NZ8 * D36NX7D35NY7D33NZ7;
        stiffness(21, 21) += NX8 * D11NX8D14NY8D16NZ8 + NY8 * D14NX8D44NY8D46NZ8 + NZ8 * D16NX8D46NY8D66NZ8;
        stiffness(21, 22) += NX8 * D14NX8D44NY8D46NZ8 + NY8 * D12NX8D24NY8D26NZ8 + NZ8 * D15NX8D45NY8D56NZ8;
        stiffness(21, 23) += NX8 * D16NX8D46NY8D66NZ8 + NY8 * D15NX8D45NY8D56NZ8 + NZ8 * D13NX8D34NY8D36NZ8;
        stiffness(22, 22) += NX8 * D44NX8D24NY8D45NZ8 + NY8 * D24NX8D22NY8D25NZ8 + NZ8 * D45NX8D25NY8D55NZ8;
        stiffness(22, 23) += NX8 * D46NX8D26NY8D56NZ8 + NY8 * D45NX8D25NY8D55NZ8 + NZ8 * D34NX8D23NY8D35NZ8;
        stiffness(23, 23) += NX8 * D66NX8D56NY8D36NZ8 + NY8 * D56NX8D55NY8D35NZ8 + NZ8 * D36NX8D35NY8D33NZ8;

        resistance(0) += NX1 * S1 + NY1 * S4 + NZ1 * S6;
        resistance(1) += NX1 * S4 + NY1 * S2 + NZ1 * S5;
        resistance(2) += NX1 * S6 + NY1 * S5 + NZ1 * S3;
        resistance(3) += NX2 * S1 + NY2 * S4 + NZ2 * S6;
        resistance(4) += NX2 * S4 + NY2 * S2 + NZ2 * S5;
        resistance(5) += NX2 * S6 + NY2 * S5 + NZ2 * S3;
        resistance(6) += NX3 * S1 + NY3 * S4 + NZ3 * S6;
        resistance(7) += NX3 * S4 + NY3 * S2 + NZ3 * S5;
        resistance(8) += NX3 * S6 + NY3 * S5 + NZ3 * S3;
        resistance(9) += NX4 * S1 + NY4 * S4 + NZ4 * S6;
        resistance(10) += NX4 * S4 + NY4 * S2 + NZ4 * S5;
        resistance(11) += NX4 * S6 + NY4 * S5 + NZ4 * S3;
        resistance(12) += NX5 * S1 + NY5 * S4 + NZ5 * S6;
        resistance(13) += NX5 * S4 + NY5 * S2 + NZ5 * S5;
        resistance(14) += NX5 * S6 + NY5 * S5 + NZ5 * S3;
        resistance(15) += NX6 * S1 + NY6 * S4 + NZ6 * S6;
        resistance(16) += NX6 * S4 + NY6 * S2 + NZ6 * S5;
        resistance(17) += NX6 * S6 + NY6 * S5 + NZ6 * S3;
        resistance(18) += NX7 * S1 + NY7 * S4 + NZ7 * S6;
        resistance(19) += NX7 * S4 + NY7 * S2 + NZ7 * S5;
        resistance(20) += NX7 * S6 + NY7 * S5 + NZ7 * S3;
        resistance(21) += NX8 * S1 + NY8 * S4 + NZ8 * S6;
        resistance(22) += NX8 * S4 + NY8 * S2 + NZ8 * S5;
        resistance(23) += NX8 * S6 + NY8 * S5 + NZ8 * S3;
    }

    for(auto I = 0; I < 23; ++I)
        for(auto J = I + 1; J < 24; ++J) stiffness(J, I) = stiffness(I, J);

    return code;
}

int C3D8::commit_status() {
    auto code = 0;
    for(const auto& I : int_pt) code += I.c_material->commit_status();
    return code;
}

int C3D8::clear_status() {
    auto code = 0;
    for(const auto& I : int_pt) code += I.c_material->clear_status();
    return code;
}

int C3D8::reset_status() {
    auto code = 0;
    for(const auto& I : int_pt) code += I.c_material->reset_status();
    return code;
}

void C3D8::print() { suanpan_info("C3D8(R) element.\n"); }
